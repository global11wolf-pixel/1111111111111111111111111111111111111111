-- UI Library для Roblox
-- Загружается с GitHub и используется для создания интерфейса

local UI = {}
UI.__index = UI

-- Цвета по умолчанию
UI.Colors = {
    Primary = Color3.fromRGB(150, 17, 255),
    Background = Color3.fromRGB(35, 35, 35),
    BackgroundTransparency = 0.2,
    Text = Color3.fromRGB(255, 255, 255),
    TextSecondary = Color3.fromRGB(161, 161, 161),
    ToggleOff = Color3.fromRGB(29, 29, 29),
    ToggleOn = Color3.fromRGB(150, 17, 255),
}

-- Создание основного окна
function UI.new(options)
    options = options or {}
    local self = setmetatable({}, UI)
    
    local Player = game:GetService("Players").LocalPlayer
    
    -- Создание ScreenGui
    self.ScreenGui = Instance.new("ScreenGui")
    self.ScreenGui.Name = options.Name or "UI"
    self.ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
    self.ScreenGui.Parent = Player:WaitForChild("PlayerGui")
    
    -- Создание MainFrame
    self.MainFrame = Instance.new("Frame")
    self.MainFrame.Name = "MainFrame"
    self.MainFrame.Size = options.Size or UDim2.new(0, 584, 0, 360)
    self.MainFrame.Position = options.Position or UDim2.new(0.24751894176006317, 0, 0.314193457365036, 0)
    self.MainFrame.BackgroundColor3 = options.BackgroundColor or UI.Colors.Background
    self.MainFrame.BackgroundTransparency = UI.Colors.BackgroundTransparency
    self.MainFrame.BorderColor3 = Color3.fromRGB(70, 70, 70)
    self.MainFrame.BorderSizePixel = 0
    self.MainFrame.AnchorPoint = Vector2.new(0, 0)
    self.MainFrame.Parent = self.ScreenGui
    
    local UICorner = Instance.new("UICorner")
    UICorner.Parent = self.MainFrame
    
    -- Logo Zone
    self.LogoZone = Instance.new("Frame")
    self.LogoZone.Name = "LogoZone"
    self.LogoZone.Size = UDim2.new(0, 140, 0, 40)
    self.LogoZone.Position = UDim2.new(-0.0018518518190830946, 0, 0, 0)
    self.LogoZone.BackgroundTransparency = 1
    self.LogoZone.BorderSizePixel = 0
    self.LogoZone.Parent = self.MainFrame
    
    -- Tab Zone
    self.TabZone = Instance.new("Frame")
    self.TabZone.Name = "TabZone"
    self.TabZone.Size = UDim2.new(0, 140, 0, 280)
    self.TabZone.Position = UDim2.new(0, 0, 0.12857140600681305, 0)
    self.TabZone.BackgroundTransparency = 1
    self.TabZone.BorderSizePixel = 0
    self.TabZone.Parent = self.MainFrame
    
    -- Element Container
    self.ElementContainer = Instance.new("Frame")
    self.ElementContainer.Name = "ElementContainer"
    self.ElementContainer.BackgroundColor3 = Color3.fromRGB(38, 38, 38)
    self.ElementContainer.BackgroundTransparency = 0.2
    self.ElementContainer.BorderSizePixel = 0
    self.ElementContainer.Position = UDim2.new(0.228658706, 0, 0, 0)
    self.ElementContainer.Size = UDim2.new(0, 450, 0, 360)
    self.ElementContainer.Parent = self.MainFrame
    
    local UICorner_2 = Instance.new("UICorner")
    UICorner_2.Parent = self.ElementContainer
    
    -- Element Zone (для элементов табов)
    self.ElementZone = Instance.new("Frame")
    self.ElementZone.Name = "ElementZone"
    self.ElementZone.BackgroundTransparency = 1
    self.ElementZone.BorderSizePixel = 0
    self.ElementZone.Position = UDim2.new(0, 0, 0.113534883, 0)
    self.ElementZone.Size = UDim2.new(0, 437, 0, 309)
    self.ElementZone.Parent = self.ElementContainer
    
    -- Opened Tab Label
    self.OpenedTab = Instance.new("TextLabel")
    self.OpenedTab.Name = "OpenedTab"
    self.OpenedTab.Size = UDim2.new(0, 79, 0, 30)
    self.OpenedTab.Position = UDim2.new(0.021381428465247154, 0, 0.01666666753590107, 0)
    self.OpenedTab.BackgroundTransparency = 1
    self.OpenedTab.BorderSizePixel = 0
    self.OpenedTab.Text = "Tab 1"
    self.OpenedTab.TextColor3 = UI.Colors.Text
    self.OpenedTab.TextSize = 16
    self.OpenedTab.Font = Enum.Font.SourceSansBold
    self.OpenedTab.TextXAlignment = Enum.TextXAlignment.Left
    self.OpenedTab.Parent = self.ElementContainer
    
    -- Хранилище табов
    self.Tabs = {}
    self.CurrentTab = nil
    self.TabContainers = {}
    
    return self
end

-- Создание таба
function UI:CreateTab(name, icon)
    icon = icon or "rbxassetid://12614416478"
    
    local tabButton = Instance.new("TextButton")
    tabButton.Name = "Tab_" .. name
    tabButton.Size = UDim2.new(0, 120, 0, 25)
    tabButton.Position = UDim2.new(0.06428571790456772, 0, 0.0535714291036129 + (#self.Tabs * 0.089285714), 0)
    tabButton.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    tabButton.BackgroundTransparency = #self.Tabs == 0 and 0.9 or 0.95
    tabButton.BorderSizePixel = 0
    tabButton.Text = ""
    tabButton.Parent = self.TabZone
    
    local UICorner = Instance.new("UICorner")
    UICorner.Parent = tabButton
    
    local TabLogo = Instance.new("ImageLabel")
    TabLogo.Name = "TabLogo"
    TabLogo.Size = UDim2.new(0, 14, 0, 14)
    TabLogo.Position = UDim2.new(0.06666667014360428, 0, 0.20000000298023224, 0)
    TabLogo.BackgroundTransparency = 1
    TabLogo.BorderSizePixel = 0
    TabLogo.Image = icon
    TabLogo.ImageColor3 = #self.Tabs == 0 and UI.Colors.Primary or UI.Colors.TextSecondary
    TabLogo.Parent = tabButton
    
    local TabName = Instance.new("TextLabel")
    TabName.Name = "TabName"
    TabName.Size = UDim2.new(0, 89, 0, 23)
    TabName.Position = UDim2.new(0.25, 0, -0.03999878093600273, 0)
    TabName.BackgroundTransparency = 1
    TabName.BorderSizePixel = 0
    TabName.Text = name
    TabName.TextColor3 = #self.Tabs == 0 and UI.Colors.Primary or UI.Colors.TextSecondary
    TabName.TextSize = 14
    TabName.Font = Enum.Font.SourceSansBold
    TabName.TextXAlignment = Enum.TextXAlignment.Left
    TabName.Parent = tabButton
    
    -- Контейнер для элементов таба
    local tabContainer = Instance.new("Frame")
    tabContainer.Name = "TabContainer_" .. name
    tabContainer.BackgroundTransparency = 1
    tabContainer.BorderSizePixel = 0
    tabContainer.Size = UDim2.new(1, 0, 1, 0)
    tabContainer.Position = UDim2.new(0, 0, 0, 0)
    tabContainer.Visible = #self.Tabs == 0
    tabContainer.Parent = self.ElementZone
    
    -- Обработчик клика
    tabButton.MouseButton1Click:Connect(function()
        self:SwitchTab(name)
    end)
    
    -- Сохранение таба
    local tabData = {
        Name = name,
        Button = tabButton,
        Container = tabContainer,
        Logo = TabLogo,
        TabName = TabName,
        Sections = {}
    }
    
    table.insert(self.Tabs, tabData)
    self.TabContainers[name] = tabContainer
    
    if #self.Tabs == 1 then
        self.CurrentTab = name
    end
    
    return tabData
end

-- Переключение таба
function UI:SwitchTab(tabName)
    if self.CurrentTab == tabName then return end
    
    -- Скрыть текущий таб
    if self.CurrentTab and self.TabContainers[self.CurrentTab] then
        self.TabContainers[self.CurrentTab].Visible = false
        local oldTab = self.Tabs[self:GetTabIndex(self.CurrentTab)]
        if oldTab then
            oldTab.Button.BackgroundTransparency = 0.95
            oldTab.Logo.ImageColor3 = UI.Colors.TextSecondary
            oldTab.TabName.TextColor3 = UI.Colors.TextSecondary
        end
    end
    
    -- Показать новый таб
    if self.TabContainers[tabName] then
        self.TabContainers[tabName].Visible = true
        local newTab = self.Tabs[self:GetTabIndex(tabName)]
        if newTab then
            newTab.Button.BackgroundTransparency = 0.9
            newTab.Logo.ImageColor3 = UI.Colors.Primary
            newTab.TabName.TextColor3 = UI.Colors.Primary
        end
        self.OpenedTab.Text = tabName
        self.CurrentTab = tabName
    end
end

-- Получить индекс таба
function UI:GetTabIndex(tabName)
    for i, tab in ipairs(self.Tabs) do
        if tab.Name == tabName then
            return i
        end
    end
    return nil
end

-- Создание секции
function UI:CreateSection(tabName, sectionName, position)
    local tab = self.Tabs[self:GetTabIndex(tabName)]
    if not tab then return nil end
    
    position = position or {X = 0.02, Y = 0.066}
    
    local section = Instance.new("Frame")
    section.Name = "Section_" .. sectionName
    section.BackgroundColor3 = Color3.fromRGB(22, 22, 22)
    section.BackgroundTransparency = 0.6
    section.BorderSizePixel = 0
    section.Size = UDim2.new(0, 210, 0, 100)
    section.Position = UDim2.new(position.X, 0, position.Y, 0)
    section.Parent = tab.Container
    
    local UICorner = Instance.new("UICorner")
    UICorner.Parent = section
    
    local SectionNameLabel = Instance.new("TextLabel")
    SectionNameLabel.Name = "SectionName"
    SectionNameLabel.Size = UDim2.new(0, 78, 0, 19)
    SectionNameLabel.Position = UDim2.new(0.0378378369, 0, -0.193333432, 0)
    SectionNameLabel.BackgroundTransparency = 1
    SectionNameLabel.BorderSizePixel = 0
    SectionNameLabel.Text = sectionName
    SectionNameLabel.TextColor3 = UI.Colors.TextSecondary
    SectionNameLabel.TextSize = 12
    SectionNameLabel.Font = Enum.Font.SourceSansBold
    SectionNameLabel.TextXAlignment = Enum.TextXAlignment.Left
    SectionNameLabel.Parent = section
    
    local sectionData = {
        Name = sectionName,
        Frame = section,
        Elements = {},
        YOffset = 0
    }
    
    table.insert(tab.Sections, sectionData)
    
    return sectionData
end

-- Создание кнопки
function UI:CreateButton(tabName, sectionName, buttonName, callback)
    local tab = self.Tabs[self:GetTabIndex(tabName)]
    if not tab then return nil end
    
    local section = nil
    for _, sec in ipairs(tab.Sections) do
        if sec.Name == sectionName then
            section = sec
            break
        end
    end
    
    if not section then return nil end
    
    local buttonZone = Instance.new("Frame")
    buttonZone.Name = "ButtonZone"
    buttonZone.BackgroundTransparency = 1
    buttonZone.BorderSizePixel = 0
    buttonZone.Size = UDim2.new(0, 210, 0, 35)
    buttonZone.Position = UDim2.new(0, 0, section.YOffset, 0)
    buttonZone.Parent = section.Frame
    
    local button = Instance.new("TextButton")
    button.Name = "Button"
    button.Size = UDim2.new(0, 90, 0, 25)
    button.Position = UDim2.new(0.0666666701, 0, 0.138095528, 0)
    button.BackgroundColor3 = UI.Colors.Primary
    button.BorderSizePixel = 0
    button.Text = buttonName
    button.TextColor3 = UI.Colors.Text
    button.TextSize = 15
    button.Font = Enum.Font.SourceSansBold
    button.Parent = buttonZone
    
    local UICorner = Instance.new("UICorner")
    UICorner.CornerRadius = UDim.new(0, 5)
    UICorner.Parent = button
    
    local Line = Instance.new("Frame")
    Line.Name = "Line"
    Line.Size = UDim2.new(0, 190, 0, 1)
    Line.Position = UDim2.new(0.0540540554, 0, 0.993768334, 0)
    Line.BackgroundColor3 = Color3.fromRGB(161, 161, 161)
    Line.BackgroundTransparency = 0.95
    Line.BorderSizePixel = 0
    Line.Parent = buttonZone
    
    if callback then
        button.MouseButton1Click:Connect(callback)
    end
    
    section.YOffset = section.YOffset + 0.35
    
    return button
end

-- Создание тоггла
function UI:CreateToggle(tabName, sectionName, toggleName, defaultState, callback)
    local tab = self.Tabs[self:GetTabIndex(tabName)]
    if not tab then return nil end
    
    local section = nil
    for _, sec in ipairs(tab.Sections) do
        if sec.Name == sectionName then
            section = sec
            break
        end
    end
    
    if not section then return nil end
    
    local state = defaultState or false
    
    local toggleZone = Instance.new("Frame")
    toggleZone.Name = "ToggleZone"
    toggleZone.BackgroundTransparency = 1
    toggleZone.BorderSizePixel = 0
    toggleZone.Size = UDim2.new(0, 210, 0, 30)
    toggleZone.Position = UDim2.new(0, 0, section.YOffset, 0)
    toggleZone.Parent = section.Frame
    
    local ToggleName = Instance.new("TextLabel")
    ToggleName.Name = "ToggleName"
    ToggleName.Size = UDim2.new(0, 79, 0, 30)
    ToggleName.Position = UDim2.new(0.0702702701, 0, 0, 0)
    ToggleName.BackgroundTransparency = 1
    ToggleName.BorderSizePixel = 0
    ToggleName.Text = toggleName
    ToggleName.TextColor3 = state and UI.Colors.Text or UI.Colors.TextSecondary
    ToggleName.TextSize = 14
    ToggleName.Font = Enum.Font.SourceSansBold
    ToggleName.TextXAlignment = Enum.TextXAlignment.Left
    ToggleName.Parent = toggleZone
    
    local Line = Instance.new("Frame")
    Line.Name = "Line"
    Line.Size = UDim2.new(0, 190, 0, 1)
    Line.Position = UDim2.new(0.0540540554, 0, 0.993768334, 0)
    Line.BackgroundColor3 = Color3.fromRGB(161, 161, 161)
    Line.BackgroundTransparency = 0.95
    Line.BorderSizePixel = 0
    Line.Parent = toggleZone
    
    local Toggle = Instance.new("TextButton")
    Toggle.Name = "Toggle"
    Toggle.Size = UDim2.new(0, 30, 0, 16)
    Toggle.Position = UDim2.new(0.761003792, 0, 0.233333334, 0)
    Toggle.BackgroundColor3 = state and UI.Colors.ToggleOn or UI.Colors.ToggleOff
    Toggle.BorderSizePixel = 0
    Toggle.Text = ""
    Toggle.Parent = toggleZone
    
    local UICorner = Instance.new("UICorner")
    UICorner.CornerRadius = UDim.new(1, 0)
    UICorner.Parent = Toggle
    
    local ToggleMover = Instance.new("TextButton")
    ToggleMover.Name = "ToggleMover"
    ToggleMover.Size = UDim2.new(0, 12, 0, 12)
    ToggleMover.Position = state and UDim2.new(0.44999998807907104, 2, 0.125, 0) or UDim2.new(0, 2, 0.125, 0)
    ToggleMover.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    ToggleMover.BorderSizePixel = 0
    ToggleMover.Text = ""
    ToggleMover.Parent = Toggle
    
    local UICorner_2 = Instance.new("UICorner")
    UICorner_2.CornerRadius = UDim.new(1, 0)
    UICorner_2.Parent = ToggleMover
    
    Toggle.MouseButton1Click:Connect(function()
        state = not state
        Toggle.BackgroundColor3 = state and UI.Colors.ToggleOn or UI.Colors.ToggleOff
        ToggleMover.Position = state and UDim2.new(0.44999998807907104, 2, 0.125, 0) or UDim2.new(0, 2, 0.125, 0)
        ToggleName.TextColor3 = state and UI.Colors.Text or UI.Colors.TextSecondary
        
        if callback then
            callback(state)
        end
    end)
    
    section.YOffset = section.YOffset + 0.308
    
    return {
        Toggle = Toggle,
        State = function() return state end,
        SetState = function(newState)
            state = newState
            Toggle.BackgroundColor3 = state and UI.Colors.ToggleOn or UI.Colors.ToggleOff
            ToggleMover.Position = state and UDim2.new(0.44999998807907104, 2, 0.125, 0) or UDim2.new(0, 2, 0.125, 0)
            ToggleName.TextColor3 = state and UI.Colors.Text or UI.Colors.TextSecondary
        end
    }
end

-- Создание слайдера
function UI:CreateSlider(tabName, sectionName, sliderName, min, max, default, callback)
    local tab = self.Tabs[self:GetTabIndex(tabName)]
    if not tab then return nil end
    
    local section = nil
    for _, sec in ipairs(tab.Sections) do
        if sec.Name == sectionName then
            section = sec
            break
        end
    end
    
    if not section then return nil end
    
    min = min or 0
    max = max or 100
    default = default or min
    local value = math.clamp(default, min, max)
    
    local sliderZone = Instance.new("Frame")
    sliderZone.Name = "SliderZone"
    sliderZone.BackgroundTransparency = 1
    sliderZone.BorderSizePixel = 0
    sliderZone.Size = UDim2.new(0, 210, 0, 45)
    sliderZone.Position = UDim2.new(0, 0, section.YOffset, 0)
    sliderZone.Parent = section.Frame
    
    local SliderName = Instance.new("TextLabel")
    SliderName.Name = "SliderName"
    SliderName.Size = UDim2.new(0, 120, 0, 20)
    SliderName.Position = UDim2.new(0.0512225926, 0, 0, 0)
    SliderName.BackgroundTransparency = 1
    SliderName.BorderSizePixel = 0
    SliderName.Text = sliderName
    SliderName.TextColor3 = UI.Colors.Text
    SliderName.TextSize = 14
    SliderName.Font = Enum.Font.SourceSansBold
    SliderName.TextXAlignment = Enum.TextXAlignment.Left
    SliderName.Parent = sliderZone
    
    local SliderLine = Instance.new("Frame")
    SliderLine.Name = "SliderLine"
    SliderLine.Size = UDim2.new(0, 120, 0, 4)
    SliderLine.Position = UDim2.new(0.0512225926, 0, 0.4, 0)
    SliderLine.BackgroundColor3 = Color3.fromRGB(29, 29, 29)
    SliderLine.BorderSizePixel = 0
    SliderLine.Parent = sliderZone
    
    local UICorner = Instance.new("UICorner")
    UICorner.Parent = SliderLine
    
    local SliderValue = Instance.new("Frame")
    SliderValue.Name = "SliderValue"
    SliderValue.Size = UDim2.new(0, 30, 0, 12)
    SliderValue.Position = UDim2.new(0.0512225926, 0, 0.7, 0)
    SliderValue.BackgroundColor3 = Color3.fromRGB(29, 29, 29)
    SliderValue.BorderColor3 = Color3.fromRGB(161, 161, 161)
    SliderValue.BorderSizePixel = 0
    SliderValue.Parent = sliderZone
    
    local Line = Instance.new("Frame")
    Line.Name = "Line"
    Line.Size = UDim2.new(0, 190, 0, 1)
    Line.Position = UDim2.new(0.0540540554, 0, 0.977777778, 0)
    Line.BackgroundColor3 = Color3.fromRGB(161, 161, 161)
    Line.BackgroundTransparency = 0.95
    Line.BorderSizePixel = 0
    Line.Parent = sliderZone
    
    local ValueLabel = Instance.new("TextLabel")
    ValueLabel.BackgroundTransparency = 1
    ValueLabel.BorderSizePixel = 0
    ValueLabel.Size = UDim2.new(1, 0, 1, 0)
    ValueLabel.Text = tostring(value)
    ValueLabel.TextColor3 = UI.Colors.Text
    ValueLabel.TextSize = 10
    ValueLabel.Font = Enum.Font.SourceSans
    ValueLabel.Parent = SliderValue
    
    local SliderDot = Instance.new("Frame")
    SliderDot.Name = "SliderDot"
    SliderDot.Size = UDim2.new(0, 10, 0, 10)
    SliderDot.BackgroundColor3 = UI.Colors.Primary
    SliderDot.BorderSizePixel = 0
    SliderDot.Parent = SliderLine
    
    local UICorner_2 = Instance.new("UICorner")
    UICorner_2.CornerRadius = UDim.new(1, 0)
    UICorner_2.Parent = SliderDot
    
    local function updateSlider(newValue)
        value = math.clamp(newValue, min, max)
        local percentage = (value - min) / (max - min)
        SliderDot.Position = UDim2.new(percentage * 0.875, 0, -0.75, 0)
        ValueLabel.Text = tostring(math.floor(value))
        if callback then
            callback(value)
        end
    end
    
    SliderLine.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            local connection
            connection = game:GetService("UserInputService").InputChanged:Connect(function(moveInput)
                if moveInput.UserInputType == Enum.UserInputType.MouseMovement then
                    local relativeX = moveInput.Position.X - SliderLine.AbsolutePosition.X
                    local percentage = math.clamp(relativeX / SliderLine.AbsoluteSize.X, 0, 1)
                    local newValue = min + (percentage * (max - min))
                    updateSlider(newValue)
                end
            end)
            game:GetService("UserInputService").InputEnded:Connect(function(endInput)
                if endInput.UserInputType == Enum.UserInputType.MouseButton1 then
                    connection:Disconnect()
                end
            end)
        end
    end)
    
    updateSlider(default)
    section.YOffset = section.YOffset + 0.45
    
    return {
        Value = function() return value end,
        SetValue = updateSlider
    }
end

-- Создание дропдауна
function UI:CreateDropdown(tabName, sectionName, dropdownName, options, default, callback)
    local tab = self.Tabs[self:GetTabIndex(tabName)]
    if not tab then return nil end
    
    local section = nil
    for _, sec in ipairs(tab.Sections) do
        if sec.Name == sectionName then
            section = sec
            break
        end
    end
    
    if not section then return nil end
    
    options = options or {}
    local selected = default or options[1] or ""
    local isOpen = false
    
    local dropdownZone = Instance.new("Frame")
    dropdownZone.Name = "DropdownZone"
    dropdownZone.BackgroundTransparency = 1
    dropdownZone.BorderSizePixel = 0
    dropdownZone.Size = UDim2.new(0, 210, 0, 35)
    dropdownZone.Position = UDim2.new(0, 0, section.YOffset, 0)
    dropdownZone.Parent = section.Frame
    
    local DropdownName = Instance.new("TextLabel")
    DropdownName.Name = "DropdownName"
    DropdownName.Size = UDim2.new(0, 76, 0, 34)
    DropdownName.Position = UDim2.new(0.0540540405, 0, 0.0114222933, 0)
    DropdownName.BackgroundTransparency = 1
    DropdownName.BorderSizePixel = 0
    DropdownName.Text = dropdownName
    DropdownName.TextColor3 = UI.Colors.Text
    DropdownName.TextSize = 12
    DropdownName.Font = Enum.Font.SourceSansBold
    DropdownName.TextXAlignment = Enum.TextXAlignment.Left
    DropdownName.Parent = dropdownZone
    
    local DropdownButton = Instance.new("TextButton")
    DropdownButton.Name = "DropdownButton"
    DropdownButton.Size = UDim2.new(0, 111, 0, 24)
    DropdownButton.Position = UDim2.new(0.422651023, 0, 0.134209335, 0)
    DropdownButton.BackgroundColor3 = Color3.fromRGB(29, 29, 29)
    DropdownButton.BorderSizePixel = 0
    DropdownButton.Text = ""
    DropdownButton.ClipsDescendants = true
    DropdownButton.Parent = dropdownZone
    
    local UICorner = Instance.new("UICorner")
    UICorner.CornerRadius = UDim.new(0, 4)
    UICorner.Parent = DropdownButton
    
    local Selected = Instance.new("TextLabel")
    Selected.Name = "Selected"
    Selected.Size = UDim2.new(0, 104, 0, 13)
    Selected.Position = UDim2.new(0.0558559671, 0, 0.208333328, 0)
    Selected.BackgroundTransparency = 1
    Selected.BorderSizePixel = 0
    Selected.Text = selected
    Selected.TextColor3 = UI.Colors.Text
    Selected.TextSize = 12
    Selected.Font = Enum.Font.SourceSansBold
    Selected.TextXAlignment = Enum.TextXAlignment.Left
    Selected.Parent = DropdownButton
    
    local Arrow = Instance.new("ImageButton")
    Arrow.Name = "Arrow"
    Arrow.Size = UDim2.new(0, 10, 0, 10)
    Arrow.Position = UDim2.new(0.867056608, 0, 0.265472412, 0)
    Arrow.BackgroundTransparency = 1
    Arrow.BorderSizePixel = 0
    Arrow.Image = "rbxassetid://13116390649"
    Arrow.ImageColor3 = UI.Colors.Text
    Arrow.Parent = DropdownButton
    
    local Line = Instance.new("Frame")
    Line.Name = "Line"
    Line.Size = UDim2.new(0, 190, 0, 1)
    Line.Position = UDim2.new(0.0540540554, 0, 0.993768334, 0)
    Line.BackgroundColor3 = Color3.fromRGB(161, 161, 161)
    Line.BackgroundTransparency = 0.95
    Line.BorderSizePixel = 0
    Line.Parent = dropdownZone
    
    DropdownButton.MouseButton1Click:Connect(function()
        -- Простая реализация - можно расширить для открытия списка
        if callback then
            callback(selected)
        end
    end)
    
    section.YOffset = section.YOffset + 0.35
    
    return {
        Selected = function() return selected end,
        SetSelected = function(newSelected)
            selected = newSelected
            Selected.Text = selected
            if callback then
                callback(selected)
            end
        end
    }
end

-- Создание текстового поля ввода
function UI:CreateInput(tabName, sectionName, inputName, placeholder, callback)
    local tab = self.Tabs[self:GetTabIndex(tabName)]
    if not tab then return nil end
    
    local section = nil
    for _, sec in ipairs(tab.Sections) do
        if sec.Name == sectionName then
            section = sec
            break
        end
    end
    
    if not section then return nil end
    
    local inputZone = Instance.new("Frame")
    inputZone.Name = "InputZone"
    inputZone.BackgroundTransparency = 1
    inputZone.BorderSizePixel = 0
    inputZone.Size = UDim2.new(0, 210, 0, 40)
    inputZone.Position = UDim2.new(0, 0, section.YOffset, 0)
    inputZone.Parent = section.Frame
    
    local InputName = Instance.new("TextLabel")
    InputName.Name = "InputName"
    InputName.Size = UDim2.new(0, 79, 0, 14)
    InputName.Position = UDim2.new(0.137346908, 0, -0.00832824688, 0)
    InputName.BackgroundTransparency = 1
    InputName.BorderSizePixel = 0
    InputName.Text = inputName
    InputName.TextColor3 = UI.Colors.Text
    InputName.TextSize = 10
    InputName.Font = Enum.Font.SourceSans
    InputName.TextXAlignment = Enum.TextXAlignment.Left
    InputName.Parent = inputZone
    
    local Input = Instance.new("TextButton")
    Input.Name = "Input"
    Input.Size = UDim2.new(0, 170, 0, 20)
    Input.Position = UDim2.new(0.0909999982, 0, 0.349999994, 0)
    Input.BackgroundColor3 = Color3.fromRGB(29, 29, 29)
    Input.BorderSizePixel = 0
    Input.Text = ""
    Input.Parent = inputZone
    
    local UICorner = Instance.new("UICorner")
    UICorner.CornerRadius = UDim.new(0, 4)
    UICorner.Parent = Input
    
    local InputValue = Instance.new("TextLabel")
    InputValue.Name = "InputValue"
    InputValue.Size = UDim2.new(0, 150, 0, 19)
    InputValue.Position = UDim2.new(0.0588235296, 0, 0, 0)
    InputValue.BackgroundTransparency = 1
    InputValue.BorderSizePixel = 0
    InputValue.Text = placeholder or ""
    InputValue.TextColor3 = UI.Colors.Text
    InputValue.TextSize = 10
    InputValue.Font = Enum.Font.SourceSansBold
    InputValue.TextXAlignment = Enum.TextXAlignment.Left
    InputValue.Parent = Input
    
    local Line = Instance.new("Frame")
    Line.Name = "Line"
    Line.Size = UDim2.new(0, 190, 0, 1)
    Line.Position = UDim2.new(0.0540540554, 0, 0.993768334, 0)
    Line.BackgroundColor3 = Color3.fromRGB(161, 161, 161)
    Line.BackgroundTransparency = 0.95
    Line.BorderSizePixel = 0
    Line.Parent = inputZone
    
    Input.MouseButton1Click:Connect(function()
        local textBox = Instance.new("TextBox")
        textBox.Size = UDim2.new(1, 0, 1, 0)
        textBox.Position = UDim2.new(0, 0, 0, 0)
        textBox.BackgroundTransparency = 1
        textBox.BorderSizePixel = 0
        textBox.Text = InputValue.Text
        textBox.TextColor3 = UI.Colors.Text
        textBox.TextSize = 10
        textBox.Font = Enum.Font.SourceSansBold
        textBox.TextXAlignment = Enum.TextXAlignment.Left
        textBox.PlaceholderText = placeholder or ""
        textBox.PlaceholderColor3 = UI.Colors.TextSecondary
        textBox.Parent = Input
        
        textBox.FocusLost:Connect(function(enterPressed)
            InputValue.Text = textBox.Text
            if callback then
                callback(textBox.Text)
            end
            textBox:Destroy()
        end)
        textBox:CaptureFocus()
    end)
    
    section.YOffset = section.YOffset + 0.4
    
    return {
        Value = function() return InputValue.Text end,
        SetValue = function(newValue)
            InputValue.Text = newValue
            if callback then
                callback(newValue)
            end
        end
    }
end

-- Создание бинда (привязки клавиши)
function UI:CreateBind(tabName, sectionName, bindName, defaultKey, callback)
    local tab = self.Tabs[self:GetTabIndex(tabName)]
    if not tab then return nil end
    
    local section = nil
    for _, sec in ipairs(tab.Sections) do
        if sec.Name == sectionName then
            section = sec
            break
        end
    end
    
    if not section then return nil end
    
    local currentKey = defaultKey or "B"
    local listening = false
    
    local bindZone = Instance.new("Frame")
    bindZone.Name = "BindZone"
    bindZone.BackgroundTransparency = 1
    bindZone.BorderSizePixel = 0
    bindZone.Size = UDim2.new(0, 210, 0, 30)
    bindZone.Position = UDim2.new(0, 0, section.YOffset, 0)
    bindZone.Parent = section.Frame
    
    local BindName = Instance.new("TextLabel")
    BindName.Name = "BindName"
    BindName.Size = UDim2.new(0, 79, 0, 30)
    BindName.Position = UDim2.new(0.0512225926, 0, -0.0333333351, 0)
    BindName.BackgroundTransparency = 1
    BindName.BorderSizePixel = 0
    BindName.Text = bindName
    BindName.TextColor3 = UI.Colors.Text
    BindName.TextSize = 14
    BindName.Font = Enum.Font.SourceSansBold
    BindName.TextXAlignment = Enum.TextXAlignment.Left
    BindName.Parent = bindZone
    
    local Bind = Instance.new("TextButton")
    Bind.Name = "Bind"
    Bind.Size = UDim2.new(0, 60, 0, 15)
    Bind.Position = UDim2.new(0.600000024, 0, 0.233333334, 0)
    Bind.BackgroundColor3 = Color3.fromRGB(29, 29, 29)
    Bind.BorderSizePixel = 0
    Bind.Text = ""
    Bind.Parent = bindZone
    
    local UICorner = Instance.new("UICorner")
    UICorner.CornerRadius = UDim.new(0, 4)
    UICorner.Parent = Bind
    
    local BindName_2 = Instance.new("TextLabel")
    BindName_2.Name = "BindName"
    BindName_2.Size = UDim2.new(1, 0, 1, 0)
    BindName_2.BackgroundTransparency = 1
    BindName_2.BorderSizePixel = 0
    BindName_2.Text = currentKey
    BindName_2.TextColor3 = UI.Colors.Text
    BindName_2.TextSize = 12
    BindName_2.Font = Enum.Font.SourceSansBold
    BindName_2.Parent = Bind
    
    local Line = Instance.new("Frame")
    Line.Name = "Line"
    Line.Size = UDim2.new(0, 190, 0, 1)
    Line.Position = UDim2.new(0.0540540554, 0, 0.993768334, 0)
    Line.BackgroundColor3 = Color3.fromRGB(161, 161, 161)
    Line.BackgroundTransparency = 0.95
    Line.BorderSizePixel = 0
    Line.Parent = bindZone
    
    Bind.MouseButton1Click:Connect(function()
        listening = true
        BindName_2.Text = "..."
        Bind.BackgroundColor3 = UI.Colors.Primary
        
        local connection
        connection = game:GetService("UserInputService").InputBegan:Connect(function(input, gameProcessed)
            if not gameProcessed and listening then
                if input.KeyCode ~= Enum.KeyCode.Unknown then
                    currentKey = input.KeyCode.Name
                    BindName_2.Text = currentKey
                    Bind.BackgroundColor3 = Color3.fromRGB(29, 29, 29)
                    listening = false
                    connection:Disconnect()
                    if callback then
                        callback(currentKey)
                    end
                end
            end
        end)
    end)
    
    section.YOffset = section.YOffset + 0.308
    
    return {
        Key = function() return currentKey end,
        SetKey = function(newKey)
            currentKey = newKey
            BindName_2.Text = currentKey
            if callback then
                callback(currentKey)
            end
        end
    }
end

return UI

